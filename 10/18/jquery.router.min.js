!function(a,t,e){if(t&&t.fn){var n={handlers:[]},r=e&&e.pushState,o={noTrigger:!1},i={pathname:/^\/(?=[^?]*)/,routeparams:/:[^\/]+/g},h={routeChanged:"routeChanged",hashchange:"hashchange",popstate:"popstate"},s={invalidPath:"Path is invalid"};if(!t.router){if(t.router={events:h,init:function(){var e={eventType:r?h.popstate:h.hashchange,hash:!r,route:r?a.location.pathname:a.location.hash};t.router.events.trigger(h.routeChanged,{data:e}),a.location.hash&&t(a).trigger(h.hashchange)},historySupported:r},t.router.events.trigger=function(e,i){(function(e,i){(i=t.extend(i,{})).data=t.extend({},i.data);var h=i.data.hash;n.handlers.forEach(function(t){t.eventName===e&&(r&&!h&&f(t.route,a.location.pathname,i)?t.handler(i.data,i.params,d()):h&&(a.location.hash||r||!f(t.route,a.location.pathname,i)?f(t.route,a.location.hash.substring(1),i)&&t.handler(i.data,i.params,d()):(o.data=i.data,a.location.replace("#"+a.location.pathname))))})}).apply(this,[e,i])},!t.fn.route){var u=t.fn.route=function(){(function(a,t){n.handlers.push({eventName:h.routeChanged,handler:t.bind(this),element:this,route:a})}).apply(this,arguments)};t.route||(t.route=u.bind(null))}t.router.set=function(){(function(n,i,s){if(n){var u=null,p="",c="",d=!1,g=!1,f=i?"replaceState":"pushState";o.noTrigger=s,"object"==typeof n?(o.data={data:n.data},u=n.title,p=n.route,c=n.queryString,d=n.appendQuery):"string"==typeof n&&(o.data={data:{}},p=n),"#"===p.charAt(0)&&(g=!0,p=p.replace("#","")),r&&!g?(e[f](o.data,u,l(p,c,d)),s||(o.data.data=t.extend({},o.data.data,{eventType:h.popstate,hash:!1,route:p}),t.router.events.trigger(h.routeChanged,o.data))):i?a.location.replace("#"+l(p,c,d)):a.location.hash=l(p,c,d)}}).apply(this,arguments)}}n.init=function(){t(a).on(h.popstate,function(t){c.apply(this,[a.location.pathname,t.type])}),t(a).on(h.hashchange,function(t){c.apply(this,[a.location.hash,t.type,!0])})},n.init()}function p(a){return Array.prototype.slice.call(a)}function c(a,e,n){n=!!n,o.noTrigger&&e===h.hashchange?o.noTrigger=!1:(o.data=o.data||{data:{}},o.data.data=t.extend({},o.data.data,{eventType:e,hash:n,route:a}),t.router.events.trigger(h.routeChanged,o.data))}function d(){var e=t.deparam(a.location.search),n={};return a.location.hash.match(/\?.+/)&&(n=t.deparam(a.location.hash.match(/\?.+/)[0])),t.extend(e,n)}function l(t,e,n){if("string"==typeof(u=t)&&i.pathname.test(u))return r=t,h=n,(o=e)||h?"string"==typeof o?(o=o.trim())&&h?r+a.location.search+"&"+o.replace("?",""):o?r+"?"+o.replace("?",""):r:void 0:r;var r,o,h,u;!function(a){throw new Error(a)}(s.invalidPath)}function g(a){return a.replace(/^([^a-zA-Z0-9]+)|([^a-zA-Z0-9]+)$/g,"")}function f(a,t,e){if(~t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),i.routeparams.lastIndex=0,!i.routeparams.test(a))return a===t||"*"===a;e.params={};var n=new RegExp(a.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(n.test(t)){i.routeparams.lastIndex=0;var r=p(a.match(i.routeparams)).map(g),o=p(t.match(n));return o.shift(),r.forEach(function(a,t){e.params[a]=o[t]}),!0}return!1}}(window,window.jQuery,window.history);